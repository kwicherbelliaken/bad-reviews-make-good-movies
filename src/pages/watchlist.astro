---
import Header from "../components/Header";
import Layout from "../layouts/Layout.astro";
import { UpdateWatchlistForm } from "../components/UpdateUser";
import WatchlistMovie from "../components/Watchlist/WatchlistMovie.astro";

const username = "trial-user";
const watchlistId = "8JWw9ZPsUtkD-14h0Fnzs";

const response = await fetch(
  `https://hh2877m7a0.execute-api.ap-southeast-2.amazonaws.com/users/${username}/watchlist/${watchlistId}`,
  {
    method: "GET",
  }
);

const results = await response.json();
---

<Layout title="Welcome to Astro.">
  <main class="m-auto">
    <Header />
    <div class="flex gap-8 items-end h-[100vh] p-2 overflow-auto">
      <div class="w-[30%] h-full p-4">
        <h1>Search</h1>
        <UpdateWatchlistForm client:load />
      </div>
      <div class="w-[70%] h-full">
        {results.map((movie) => <WatchlistMovie movie={movie} />)}
      </div>
    </div>
  </main>
</Layout>
